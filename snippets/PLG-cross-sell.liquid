<style>

.ac_CS {
  position:relative;
  overflow:visible;
  margin-top:20px;
}
.ac_CS > div > h3 {
  color: #1C1B1B;
  font-family: Open Sans Condensed;
  font-size: 21px;
  font-style: normal;
  font-weight: 600;
  line-height: 1;
  letter-spacing: 2.1px;
  text-transform: uppercase;
  margin-bottom:20px;
}
.ac_CSImages > ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display:flex;
  flex-direction:row;
  align-items: flex-start;
  gap:5%;
}
.ac_CSImages > ul > li {
  border: 2px solid #F1E7DD;
  padding-inline-start: 0;
  position:relative;
  flex: 0 0 21%;
}
.ac_CSImages > ul > li > img {
  width:100%;
}
.ac_CSImages > ul > li:before {
  content: "+";
  position: absolute;
  left: -21%;
  top: calc(50% - 7px);
  width: 13%;
  height: 10px;
  font-family: Open Sans Regular;
  font-size:3.5897435897435894vw;
  font-weight:700;
  line-height: .4;
}
.ac_CSImages > ul > li:first-child:before,
.ac_CSImages > ul > li:first-child.ac_CSDisable + li:before,
.ac_CSImages > ul > li:first-child.ac_CSDisable + li:nth-child(2).ac_CSDisable + li:before,
.ac_CSImages > ul > li:first-child.ac_CSDisable + li:nth-child(2).ac_CSDisable + li:nth-child(3).ac_CSDisable + li:before {
  /* display: none; */
}
.ac_CSPricing {
  margin:13px 0;
}
.ac_CSPricing > span {
  font-family: Open Sans Condensed;
  font-style: normal;
  line-height: 1;
}
.ac_CSPricing > span:first-child {
  color: #454545;
  font-size: 16px;
  font-weight: 400;
  line-height: 1;
}
.ac_CSPricing > span:nth-child(2) {
  color: #000;
  font-size: 20px;
  font-weight: 600;
  line-height: 1;
}
.ac_CSCTA {
  position:relative;
  margin-bottom:20px;
}
.ac_CSCTA > button {
  padding: 12px 55px;
  text-align:center;
  border-radius: 3px;
  background: #000;
  color: #FFF;
  font-family: Open Sans Condensed;
  font-size: 16px;
  font-weight: 700;
  line-height: 1;
  text-transform: uppercase;
}
.upsellProducts > ul {
  list-style: none;
  margin: 0;
  padding: 0;
  position:relative;
}
.upsellProducts > ul > li {
  position:relative;
  padding-inline-start: 0;
  margin-bottom:20px;
}
.ac_CSProduct input {
  display:none;
  margin-left: 0;
}
.ac_CSProduct .ac_CSChk {
  position: absolute;
  display: block;
  top: 0;
  left: 0;
  height: 16px;
  width: 16px;
  border-radius: 3px;
  color: #ffffff;
  background-color: #000000;
  border: 1px solid #000000;
  margin-left: 0px;
}
.ac_CSProduct .ac_CSChk:after {
  content: "";
  position: absolute;
  display: none;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  border: 1px solid white;
}
.ac_CSProduct input[checked="true"] ~ .ac_CSChk:after {
  display: block;
  content: "\2713";
  position: absolute;
  top: -5px;
  left: 2px;
  border: none;
}
.ac_CSProductInfo {
  margin-left:26px;
  width: calc(100% - 26px);
  display:flex;
}
.ac_CSProductInfo > span {
  color: #000;
  font-size: 14px;
  font-style: normal;
  line-height: 1;
  text-transform: capitalize;
}
.ac_CSProductInfo > span:first-child {
  flex: 1 0 75%;
  font-family: Open Sans Condensed Medium;
  font-weight: 400;
}
.ac_CSMain {
  font-family: Open Sans Condensed;
}
.ac_CSProductInfo > span:last-child {
  flex: 1 0 25%;
  text-align:right;
  font-family: Mulish;
  font-family: Open Sans, sans-serif;
  font-weight: 600;
}
.ac_CSDisable {
  display:none;
}
@media screen and (min-width:425px){
  .ac_CSProduct input[checked="true"] ~ .ac_CSChk:after {
    top: -4px;
    left: 2px;
  }
}
@media screen and (min-width:500px){
  .ac_CSImages > ul > li:before {
    font-size:1.4000000000000001vw;
    left: -17%;
  }
  .ac_CSProduct input[checked="true"] ~ .ac_CSChk:after {
    top: -7px;
    left: 1px;
  }
}
@media screen and (min-width:1000px){
  .ac_CSImages > ul > li:before {
    left: -21%;
  }
}
@media screen and (min-width:1375px){
  .ac_CSImages > ul > li:before {
    font-size:14px;
  }
}
  
</style>

{% if product.metafields.custom.upsells.value != blank %}

<div class="ac_CS">
   <div class="quick-view-modal"><img src=""></div>
   <div class="quick-view-modal"><img src=""></div>
   <div class="quick-view-modal"><img src=""></div>
   <div class="quick-view-modal"><img src=""></div>
  <div>
    <h3>COMPLETE THE LOOK</h3>
    <div class="ac_CSImages">
      <ul>
        {% for upsell in product.metafields.custom.upsells.value limit:4  %}
        <li><img src="{{upsell.featured_image | image_url }}"></li>
        {% endfor %}
      </ul>
    </div>
    <div class="ac_CSPricing">
      <span>Total Price:</span> <span></span> 
    </div>
    <div class="ac_CSCTA">
      <button>Add to Cart</button>
    </div>
    <div class="ac_CSProducts">
      <ul>
      {% for upsell in product.metafields.custom.upsells.value limit:4  %}
       <li>
          <label class="ac_CSProduct" for="ac_CSP{{ forloop.index }}">
            <input type="checkbox" id="ac_CSP{{ forloop.index }}" checked="true">
            <span class="ac_CSChk"></span>
            <span class="ac_CSProductInfo">
            {% if forloop.index == 1 %}
         <span><span class="ac_CSMain">This Item: </span><span class="ac_CSTitle">{{ product.title }}</span></span>
            {% else %}
            <span><span class="ac_CSMain"></span><span class="ac_CSTitle">{{ upsell.title }}</span></span>
              {% endif %}
              <span><span></span></span>
            </span>
          </label>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

{% endif %}


<script>

// for outputting data object
     const productInventory = [
        {%- for u in product.metafields.custom.upsells.value %}
          { title: '{{ u.title }}', id: '{{ u.id }}', handle: '{{u.handle}}', available: '{{ u.available }}' },
        {%- endfor %}
      ];
    console.log(productInventory)
// for outputting data object


// set up Promise.all for image fetch requests


  // empty modal div, which will populate on click
  let image = document.querySelector('.quick-view-modal > img'); 

  fetch(window.Shopify.routes.root +'/products/{{ u.handle }}?section_id={{ section.id }}')
  .then(response => response.text())
  .then(html => {
    const parser = new DOMParser();
    const doc = parser.parseFromString(html, 'text/html');
    const variantImage = doc.querySelector('modal-opener > div > img');
    console.log(variantImage)
    image.src = variantImage.src;
  })
  .catch(error => {
    console.error('Error:', error);
  });


  
</script>